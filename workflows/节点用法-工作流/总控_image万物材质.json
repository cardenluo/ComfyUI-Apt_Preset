{"id":"710fdb08-cb05-4778-b87d-a9dacb8b8b1f","revision":0,"last_node_id":60,"last_link_id":77,"nodes":[{"id":29,"type":"Stack_IPA","pos":[-392.70281982421875,2495.31396484375],"size":[315,242],"flags":{},"order":4,"mode":0,"inputs":[{"localized_name":"图像","name":"image","shape":7,"type":"IMAGE","link":18},{"localized_name":"关注层遮罩","name":"attn_mask","shape":7,"type":"MASK","link":null},{"localized_name":"ipa_stack","name":"ipa_stack","shape":7,"type":"IPA_STACK","link":null},{"localized_name":"预设","name":"preset","type":"COMBO","widget":{"name":"preset"},"link":null},{"localized_name":"权重","name":"weight","type":"FLOAT","widget":{"name":"weight"},"link":null},{"localized_name":"权重类型","name":"weight_type","type":"COMBO","widget":{"name":"weight_type"},"link":null},{"localized_name":"合并嵌入","name":"combine_embeds","type":"COMBO","widget":{"name":"combine_embeds"},"link":null},{"localized_name":"开始位置","name":"start_at","type":"FLOAT","widget":{"name":"start_at"},"link":null},{"localized_name":"结束位置","name":"end_at","type":"FLOAT","widget":{"name":"end_at"},"link":null},{"localized_name":"嵌入组缩放","name":"embeds_scaling","type":"COMBO","widget":{"name":"embeds_scaling"},"link":null}],"outputs":[{"localized_name":"ipa堆","name":"ipa_stack","type":"IPA_STACK","links":[58]}],"properties":{"Node name for S&R":"Stack_IPA","enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65,"widget_ue_connectable":{}},"widgets_values":["PLUS (high strength)",2.0000000000000004,"ease in-out","concat",0,1,"V only"]},{"id":19,"type":"LoadImage","pos":[-1176.127685546875,2964.72509765625],"size":[315,314.0000305175781],"flags":{},"order":0,"mode":0,"inputs":[{"localized_name":"图像","name":"image","type":"COMBO","widget":{"name":"image"},"link":null},{"localized_name":"选择文件上传","name":"upload","type":"IMAGEUPLOAD","widget":{"name":"upload"},"link":null}],"outputs":[{"localized_name":"图像","name":"IMAGE","type":"IMAGE","slot_index":0,"links":[9]},{"localized_name":"遮罩","name":"MASK","type":"MASK","links":null}],"properties":{"cnr_id":"comfy-core","ver":"0.3.29","Node name for S&R":"LoadImage","enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65,"widget_ue_connectable":{}},"widgets_values":["pasted/image (32).png","image"]},{"id":30,"type":"LoadImage","pos":[-802.44189453125,2492.690185546875],"size":[284.0342712402344,326],"flags":{},"order":1,"mode":0,"inputs":[{"localized_name":"图像","name":"image","type":"COMBO","widget":{"name":"image"},"link":null},{"localized_name":"选择文件上传","name":"upload","type":"IMAGEUPLOAD","widget":{"name":"upload"},"link":null}],"outputs":[{"localized_name":"图像","name":"IMAGE","type":"IMAGE","links":[18]},{"localized_name":"遮罩","name":"MASK","type":"MASK","links":null}],"properties":{"cnr_id":"comfy-core","ver":"0.3.29","Node name for S&R":"LoadImage","enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65,"widget_ue_connectable":{}},"widgets_values":["pasted/image (31).png","image"]},{"id":34,"type":"basic_Ksampler_simple","pos":[909.1812744140625,1662.45458984375],"size":[397.189697265625,550.6358032226562],"flags":{},"order":12,"mode":0,"inputs":[{"localized_name":"context","name":"context","type":"RUN_CONTEXT","link":57},{"localized_name":"图像","name":"image","shape":7,"type":"IMAGE","link":null},{"localized_name":"种子","name":"seed","type":"INT","widget":{"name":"seed"},"link":null},{"localized_name":"降噪","name":"denoise","type":"FLOAT","widget":{"name":"denoise"},"link":null},{"localized_name":"图像输出","name":"image_output","type":"COMBO","widget":{"name":"image_output"},"link":null}],"outputs":[{"localized_name":"context","name":"context","type":"RUN_CONTEXT","links":null},{"localized_name":"image","name":"image","type":"IMAGE","links":[61]}],"properties":{"Node name for S&R":"basic_Ksampler_simple","widget_ue_connectable":{"seed":true,"denoise":true,"image_output":true}},"widgets_values":[576027108969035,"fixed",1,"Preview"]},{"id":21,"type":"Mask_Remove_bg","pos":[-791.3330078125,3069.719970703125],"size":[260,166],"flags":{},"order":3,"mode":0,"inputs":[{"localized_name":"图像","name":"image","type":"IMAGE","link":9},{"localized_name":"遮罩","name":"mask","shape":7,"type":"MASK","link":null},{"localized_name":"阈值","name":"threshold","type":"FLOAT","widget":{"name":"threshold"},"link":null},{"localized_name":"背景图像","name":"bg_img","type":"COMBO","widget":{"name":"bg_img"},"link":null},{"localized_name":"rem_mode","name":"rem_mode","type":"COMBO","widget":{"name":"rem_mode"},"link":null}],"outputs":[{"localized_name":"图像","name":"image","type":"IMAGE","links":[12,69]},{"localized_name":"主体遮罩","name":"mask","type":"MASK","links":[70]},{"localized_name":"背景遮罩","name":"invert_mask","type":"MASK","links":null},{"localized_name":"alpha_img","name":"alpha_img","type":"IMAGE","links":null}],"properties":{"Node name for S&R":"Mask_Remove_bg","widget_ue_connectable":{"threshold":true,"bg_img":true}},"widgets_values":[0.5,"image","RMBG-1.4"]},{"id":24,"type":"AIO_Preprocessor","pos":[-387.2624206542969,2844.73974609375],"size":[315,82],"flags":{},"order":6,"mode":0,"inputs":[{"localized_name":"image","name":"image","type":"IMAGE","link":12},{"localized_name":"preprocessor","name":"preprocessor","shape":7,"type":"COMBO","widget":{"name":"preprocessor"},"link":null},{"localized_name":"resolution","name":"resolution","shape":7,"type":"INT","widget":{"name":"resolution"},"link":null}],"outputs":[{"localized_name":"图像","name":"IMAGE","type":"IMAGE","slot_index":0,"links":[33]}],"properties":{"cnr_id":"comfyui_controlnet_aux","ver":"83463c2e4b04e729268e57f638b4212e0da4badc","Node name for S&R":"AIO_Preprocessor","enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65,"widget_ue_connectable":{}},"widgets_values":["DepthAnythingPreprocessor",1024]},{"id":43,"type":"sum_editor","pos":[-96.70258331298828,1663.6717529296875],"size":[260,444],"flags":{},"order":5,"mode":0,"inputs":[{"localized_name":"context","name":"context","type":"RUN_CONTEXT","link":38},{"localized_name":"模型","name":"model","shape":7,"type":"MODEL","link":null},{"localized_name":"CLIP","name":"clip","shape":7,"type":"CLIP","link":null},{"localized_name":"正条件","name":"positive","shape":7,"type":"CONDITIONING","link":null},{"localized_name":"负条件","name":"negative","shape":7,"type":"CONDITIONING","link":null},{"localized_name":"VAE","name":"vae","shape":7,"type":"VAE","link":null},{"localized_name":"latent","name":"latent","shape":7,"type":"LATENT","link":null},{"localized_name":"图像","name":"image","shape":7,"type":"IMAGE","link":null},{"localized_name":"步数","name":"steps","shape":7,"type":"INT","widget":{"name":"steps"},"link":null},{"localized_name":"cfg","name":"cfg","shape":7,"type":"FLOAT","widget":{"name":"cfg"},"link":null},{"localized_name":"采样器","name":"sampler","shape":7,"type":"COMBO","widget":{"name":"sampler"},"link":null},{"localized_name":"调度器","name":"scheduler","shape":7,"type":"COMBO","widget":{"name":"scheduler"},"link":null},{"localized_name":"正条件","name":"pos","shape":7,"type":"STRING","widget":{"name":"pos"},"link":null},{"localized_name":"负条件","name":"neg","shape":7,"type":"STRING","widget":{"name":"neg"},"link":null},{"localized_name":"引导","name":"guidance","shape":7,"type":"FLOAT","widget":{"name":"guidance"},"link":null},{"localized_name":"风格","name":"style","shape":7,"type":"COMBO","widget":{"name":"style"},"link":null},{"localized_name":"批次","name":"batch_size","shape":7,"type":"INT","widget":{"name":"batch_size"},"link":null},{"localized_name":"图像比例","name":"ratio_selected","shape":7,"type":"COMBO","widget":{"name":"ratio_selected"},"link":null}],"outputs":[{"localized_name":"context","name":"context","type":"RUN_CONTEXT","links":[56]},{"localized_name":"模型","name":"model","type":"MODEL","links":null},{"localized_name":"正条件","name":"positive","type":"CONDITIONING","links":null},{"localized_name":"负条件","name":"negative","type":"CONDITIONING","links":null},{"localized_name":"latent","name":"latent","type":"LATENT","links":null},{"localized_name":"VAE","name":"vae","type":"VAE","links":null},{"localized_name":"CLIP","name":"clip","type":"CLIP","links":null},{"localized_name":"图像","name":"image","type":"IMAGE","links":null}],"properties":{"Node name for S&R":"sum_editor","widget_ue_connectable":{"steps":true,"cfg":true,"sampler":true,"scheduler":true,"pos":true,"neg":true,"guidance":true,"style":true,"batch_size":true,"ratio_selected":true}},"widgets_values":[0,0,"None","None","stone ","",0,"None",1,"None"]},{"id":36,"type":"Stack_ControlNet","pos":[8.772229194641113,2746.93408203125],"size":[260,150],"flags":{},"order":8,"mode":0,"inputs":[{"localized_name":"图像","name":"image","shape":7,"type":"IMAGE","link":33},{"localized_name":"CN堆","name":"cn_stack","shape":7,"type":"CN_STACK","link":null},{"localized_name":"controlnet","name":"controlnet","shape":7,"type":"COMBO","widget":{"name":"controlnet"},"link":null},{"localized_name":"强度","name":"strength","shape":7,"type":"FLOAT","widget":{"name":"strength"},"link":null},{"localized_name":"开始","name":"start_percent","shape":7,"type":"FLOAT","widget":{"name":"start_percent"},"link":null},{"localized_name":"结束","name":"end_percent","shape":7,"type":"FLOAT","widget":{"name":"end_percent"},"link":null}],"outputs":[{"localized_name":"CN堆","name":"cn_stack","type":"CN_STACK","links":[59]}],"properties":{"Node name for S&R":"Stack_ControlNet","widget_ue_connectable":{"controlnet":true,"strength":true,"start_percent":true,"end_percent":true}},"widgets_values":["control_v11f1p_sd15_depth.pth",0.6,0,1]},{"id":59,"type":"PreviewImage","pos":[19.103975296020508,3375.03076171875],"size":[269.19561767578125,304.20916748046875],"flags":{},"order":9,"mode":0,"inputs":[{"localized_name":"图像","name":"images","type":"IMAGE","link":77}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.64","Node name for S&R":"PreviewImage"},"widgets_values":[]},{"id":49,"type":"sum_stack_image","pos":[499.47344970703125,1663.4051513671875],"size":[260,206],"flags":{},"order":11,"mode":0,"inputs":[{"localized_name":"context","name":"context","type":"RUN_CONTEXT","link":56},{"localized_name":"模型","name":"model","shape":7,"type":"MODEL","link":null},{"localized_name":"lora","name":"lora_stack","shape":7,"type":"LORASTACK","link":null},{"localized_name":"IPAdapter","name":"ipa_stack","shape":7,"type":"IPA_STACK","link":58},{"localized_name":"redux","name":"redux_stack","shape":7,"type":"REDUX_STACK","link":null},{"localized_name":"条件分区","name":"condi_stack","shape":7,"type":"STACK_CONDI","link":null},{"localized_name":"union_controlnet","name":"union_stack","shape":7,"type":"UNION_STACK","link":null},{"localized_name":"controlnet","name":"cn_stack","shape":7,"type":"CN_STACK","link":59},{"localized_name":"inpaint","name":"inpaint","shape":7,"type":"INPAINT_STACK","link":null},{"localized_name":"latent堆","name":"latent_stack","shape":7,"type":"LATENT_STACK","link":60}],"outputs":[{"localized_name":"context","name":"context","type":"RUN_CONTEXT","links":[57]},{"localized_name":"模型","name":"model","type":"MODEL","links":null},{"localized_name":"正条件","name":"positive","type":"CONDITIONING","links":null},{"localized_name":"负条件","name":"negative","type":"CONDITIONING","links":null},{"localized_name":"latent","name":"latent","type":"LATENT","links":null},{"localized_name":"vae","name":"vae","type":"VAE","links":null},{"localized_name":"clip","name":"clip","type":"CLIP","links":null},{"localized_name":"image","name":"image","type":"IMAGE","links":null}],"properties":{"Node name for S&R":"sum_stack_image","widget_ue_connectable":{}},"widgets_values":[]},{"id":44,"type":"sum_load_adv","pos":[-463.063720703125,1663.6717529296875],"size":[308.98077392578125,578],"flags":{},"order":2,"mode":0,"inputs":[{"localized_name":"覆盖模型","name":"over_model","shape":7,"type":"MODEL","link":null},{"localized_name":"覆盖clip","name":"over_clip","shape":7,"type":"CLIP","link":null},{"localized_name":"lora堆","name":"lora_stack","shape":7,"type":"LORASTACK","link":null},{"localized_name":"预设","name":"preset","shape":7,"type":"COMBO","widget":{"name":"preset"},"link":null},{"localized_name":"ckpt模型","name":"ckpt_name","shape":7,"type":"COMBO","widget":{"name":"ckpt_name"},"link":null},{"localized_name":"unet模型","name":"unet_name","shape":7,"type":"COMBO","widget":{"name":"unet_name"},"link":null},{"localized_name":"unet权重类型","name":"unet_Weight_Dtype","shape":7,"type":"COMBO","widget":{"name":"unet_Weight_Dtype"},"link":null},{"localized_name":"clip类型","name":"clip_type","shape":7,"type":"COMBO","widget":{"name":"clip_type"},"link":null},{"localized_name":"clip1","name":"clip1","shape":7,"type":"COMBO","widget":{"name":"clip1"},"link":null},{"localized_name":"clip2","name":"clip2","shape":7,"type":"COMBO","widget":{"name":"clip2"},"link":null},{"localized_name":"引导","name":"guidance","shape":7,"type":"FLOAT","widget":{"name":"guidance"},"link":null},{"localized_name":"clip3","name":"clip3","shape":7,"type":"COMBO","widget":{"name":"clip3"},"link":null},{"localized_name":"clip4","name":"clip4","shape":7,"type":"COMBO","widget":{"name":"clip4"},"link":null},{"localized_name":"VAE","name":"vae","shape":7,"type":"COMBO","widget":{"name":"vae"},"link":null},{"localized_name":"lora","name":"lora","shape":7,"type":"COMBO","widget":{"name":"lora"},"link":null},{"localized_name":"lora强度","name":"lora_strength","shape":7,"type":"FLOAT","widget":{"name":"lora_strength"},"link":null},{"localized_name":"宽度","name":"width","shape":7,"type":"INT","widget":{"name":"width"},"link":null},{"localized_name":"高度","name":"height","shape":7,"type":"INT","widget":{"name":"height"},"link":null},{"localized_name":"步数","name":"steps","shape":7,"type":"INT","widget":{"name":"steps"},"link":null},{"localized_name":"cfg","name":"cfg","shape":7,"type":"FLOAT","widget":{"name":"cfg"},"link":null},{"localized_name":"采样器","name":"sampler","shape":7,"type":"COMBO","widget":{"name":"sampler"},"link":null},{"localized_name":"调度器","name":"scheduler","shape":7,"type":"COMBO","widget":{"name":"scheduler"},"link":null},{"localized_name":"正条件","name":"pos","shape":7,"type":"STRING","widget":{"name":"pos"},"link":null},{"localized_name":"负条件","name":"neg","shape":7,"type":"STRING","widget":{"name":"neg"},"link":null}],"outputs":[{"localized_name":"context","name":"context","type":"RUN_CONTEXT","links":[38]},{"localized_name":"模型","name":"model","type":"MODEL","links":null},{"localized_name":"保存预设","name":"preset_save","type":"PDATA","links":null}],"properties":{"Node name for S&R":"sum_load_adv","widget_ue_connectable":{"preset":true,"ckpt_name":true,"unet_name":true,"unet_Weight_Dtype":true,"clip_type":true,"clip1":true,"clip2":true,"guidance":true,"clip3":true,"clip4":true,"vae":true,"lora":true,"lora_strength":true,"width":true,"height":true,"steps":true,"cfg":true,"sampler":true,"scheduler":true,"pos":true,"neg":true}},"widgets_values":["ckpt-sd.toml","AA\\majicMIX realistic _v1.safetensors","None","None","None","None","None",3.5,"None","None","A-840000-ema-pruned-real.pt","None",1,512,512,20,8,"euler","normal","beautiful detailed glow,a girl","worst quality, low quality"]},{"id":50,"type":"PreviewImage","pos":[1462.2716064453125,1682.9752197265625],"size":[761.2900390625,808.8471069335938],"flags":{},"order":13,"mode":0,"inputs":[{"localized_name":"图像","name":"images","type":"IMAGE","link":61}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.64","Node name for S&R":"PreviewImage","widget_ue_connectable":{}},"widgets_values":[]},{"id":58,"type":"Image_smooth_blur","pos":[-371.61236572265625,3055.7548828125],"size":[260,218],"flags":{},"order":7,"mode":0,"inputs":[{"localized_name":"图像","name":"image","type":"IMAGE","link":69},{"localized_name":"遮罩","name":"mask","type":"MASK","link":70},{"localized_name":"平滑度","name":"smoothness","type":"INT","widget":{"name":"smoothness"},"link":null},{"localized_name":"反转遮罩","name":"invert_mask","type":"BOOLEAN","widget":{"name":"invert_mask"},"link":null},{"localized_name":"遮罩扩展","name":"mask_expansion","type":"INT","widget":{"name":"mask_expansion"},"link":null},{"localized_name":"遮罩颜色","name":"mask_color","type":"COMBO","widget":{"name":"mask_color"},"link":null},{"localized_name":"背景颜色","name":"bg_color","type":"COMBO","widget":{"name":"bg_color"},"link":null},{"localized_name":"亮度缩放","name":"brightness","shape":7,"type":"FLOAT","widget":{"name":"brightness"},"link":null}],"outputs":[{"localized_name":"图像","name":"image","type":"IMAGE","links":[71,77]},{"localized_name":"平滑遮罩","name":"smooth_mask","type":"MASK","links":[72]},{"localized_name":"反转遮罩","name":"invert_mask","type":"MASK","links":null}],"properties":{"Node name for S&R":"Image_smooth_blur","widget_ue_connectable":{"smoothness":true,"invert_mask":true,"mask_expansion":true,"mask_color":true,"bg_color":true}},"widgets_values":[0,false,0,"image","image",0]},{"id":45,"type":"Stack_latent","pos":[45.87107467651367,3037.440185546875],"size":[260,218],"flags":{},"order":10,"mode":0,"inputs":[{"localized_name":"latent","name":"latent","shape":7,"type":"LATENT","link":null},{"localized_name":"像素","name":"pixels","shape":7,"type":"IMAGE","link":71},{"localized_name":"遮罩","name":"mask","shape":7,"type":"MASK","link":72},{"localized_name":"diff_difusion","name":"diff_difusion","shape":7,"type":"BOOLEAN","widget":{"name":"diff_difusion"},"link":null},{"localized_name":"平滑度","name":"smoothness","shape":7,"type":"INT","widget":{"name":"smoothness"},"link":null},{"localized_name":"选择比例","name":"ratio_selected","shape":7,"type":"COMBO","widget":{"name":"ratio_selected"},"link":null},{"localized_name":"批次","name":"batch_size","shape":7,"type":"INT","widget":{"name":"batch_size"},"link":null},{"localized_name":"width","name":"width","shape":7,"type":"INT","widget":{"name":"width"},"link":null},{"localized_name":"height","name":"height","shape":7,"type":"INT","widget":{"name":"height"},"link":null}],"outputs":[{"localized_name":"latent堆","name":"latent_stack","type":"LATENT_STACK","links":[60]}],"properties":{"Node name for S&R":"Stack_latent","widget_ue_connectable":{"diff_difusion":true,"smoothness":true,"ratio_selected":true,"batch_size":true,"width":true,"height":true}},"widgets_values":[true,10,"None",1,512,512]}],"links":[[9,19,0,21,0,"IMAGE"],[12,21,0,24,0,"IMAGE"],[18,30,0,29,0,"IMAGE"],[33,24,0,36,0,"IMAGE"],[38,44,0,43,0,"RUN_CONTEXT"],[56,43,0,49,0,"RUN_CONTEXT"],[57,49,0,34,0,"RUN_CONTEXT"],[58,29,0,49,3,"IPA_STACK"],[59,36,0,49,7,"CN_STACK"],[60,45,0,49,9,"LATENT_STACK"],[61,34,1,50,0,"IMAGE"],[69,21,0,58,0,"IMAGE"],[70,21,1,58,1,"MASK"],[71,58,0,45,1,"IMAGE"],[72,58,1,45,2,"MASK"],[77,58,0,59,0,"IMAGE"]],"groups":[{"id":5,"title":"主流程-图像堆","bounding":[-473.063720703125,1539.6717529296875,1866.697998046875,754.705078125],"color":"#3f789e","font_size":60,"flags":{}},{"id":6,"title":"(latent +条件+ipa) 控制流程","bounding":[-1186.127685546875,2368.690185546875,1736.89453125,955.3447265625],"color":"#3f789e","font_size":60,"flags":{}}],"config":{},"extra":{"ue_links":[],"ds":{"scale":0.7513148009015786,"offset":[1407.0587681381098,-2353.322252763552]},"links_added_by_ue":[]},"version":0.4}